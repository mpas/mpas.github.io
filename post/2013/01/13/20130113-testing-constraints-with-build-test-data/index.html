<!DOCTYPE html>
<html lang="en-US">
<head>
  
  
  <meta charset="utf-8">
  <title>CodeVerse - Testing constraints with Build Test Data</title>
  <meta name="description" content="">
  <meta name="author" content="Marco Pas">

  <meta name="generator" content="" />
  <meta name="robots" content="index,follow">

  
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">

  
  
  <link rel="stylesheet" href="/css/normalize.css">
  <link rel="stylesheet" href="/css/skeleton.css">
  
  
  <link rel="stylesheet" href="/css/font-awesome-all.min.css">
 
  
  <script src="/js/prism.js"></script>
  <link rel="stylesheet" href="/css/prism.css">
  
  
  <link rel="stylesheet" href="/css/custom.css">
  
  
  <link rel="icon" type="image/png" href="/images/favicon.png">

</head>

<div class="container">
    <div id="header">
        <div class="row">
            <div class="six columns">
                <div id="brand">
                    <a href="http://mpas.github.io">CodeVerse</a>
                </div>
            </div>
            <div class="six columns">
                <nav class="u-pull-right">
                    <ul id="navbar">
                        
                        
                            <li >
                                <a href="/">Blog</a></li>
                        
                            <li >
                                <a href="/post">Post List</a></li>
                        
                            <li >
                                <a href="/page/about/">About Me</a></li>
                        
                            <li >
                                <a href="/page/resume">Resume</a></li>
                        
                    </ul>
                </nav>
            </div>
        </div>
    </div>
</div>

  
    <div class="container">
        <div class="row">
            <div class="post-content">
                <article class="post u-cf">
    <div class="row">
        <div class="twelve columns">
            <h1 class="post-title">Testing constraints with Build Test Data</h1>
        </div>
    </div>
    <div class="row">
        <div class="twelve columns">
            <p>The <a href="http://grails.org/plugin/spock">Spock</a> &amp; <a href="http://grails.org/plugin/build-test-data">Build Test Data</a> plugins both are wonderful additions to your toolkit if you are creating tests without getting into the hassle of constantly building up your object graph. You can focus on what you want to test!</p>
<p>When testing constraints on an object it can be used as follows:</p>
<div class="highlight"><pre class="chroma"><code class="language-groovy" data-lang="groovy"><span class="kd">class</span> <span class="nc">Foo</span> <span class="o">{</span>
    <span class="n">String</span> <span class="n">name</span>   <span class="c1">// name of foo
</span><span class="c1"></span>    <span class="n">Integer</span> <span class="n">age</span>   <span class="c1">// age of foo
</span><span class="c1"></span>
    <span class="kd">static</span> <span class="n">constraints</span> <span class="o">=</span> <span class="o">{</span>
        <span class="n">name</span> <span class="nl">nullable:</span> <span class="kc">false</span><span class="o">,</span> <span class="nl">blank:</span> <span class="kc">false</span> <span class="c1">// name may never be nullable or blank
</span><span class="c1"></span>        <span class="n">age</span> <span class="nl">nullable:</span> <span class="kc">true</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div><p>And the Spock test</p>
<div class="highlight"><pre class="chroma"><code class="language-groovy" data-lang="groovy"><span class="nd">@Build</span><span class="o">(</span><span class="n">Foo</span><span class="o">)</span>
<span class="nd">@TestFor</span><span class="o">(</span><span class="n">Foo</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">FooSpec</span> <span class="kd">extends</span> <span class="n">Specification</span> <span class="o">{</span>

    <span class="kt">def</span> <span class="s2">&#34;Name of Foo must exist&#34;</span><span class="o">()</span> <span class="o">{</span>
        <span class="nl">given:</span> <span class="s2">&#34;setting up the constraints&#34;</span>
        <span class="n">mockForConstraintsTests</span><span class="o">(</span><span class="n">Foo</span><span class="o">)</span>

        <span class="nl">when:</span> <span class="s2">&#34;creating a Foo&#34;</span>
        <span class="n">Foo</span> <span class="n">foo</span> <span class="o">=</span> <span class="n">Foo</span><span class="o">.</span><span class="na">buildWithoutSave</span><span class="o">()</span>

        <span class="nl">then:</span> <span class="s2">&#34;validation should trigger&#34;</span>
        <span class="n">assertFalse</span> <span class="n">foo</span><span class="o">.</span><span class="na">validate</span><span class="o">()</span>

        <span class="nl">and:</span> <span class="s2">&#34;validation error should be on the value field&#34;</span>
        <span class="k">assert</span> <span class="n">foo</span><span class="o">.</span><span class="na">errors</span><span class="o">.</span><span class="na">allErrors</span><span class="o">.</span><span class="na">first</span><span class="o">().</span><span class="na">field</span> <span class="o">==</span> <span class="s2">&#34;name&#34;</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div>
        </div>
    </div>
    <div class="row">
        <div class="twelve columns">
            <div class="post-meta-info">
                Published on
                
                    2013-01-13
                
                <span class="post-meta-info-taxonomy">
                    
                    
                    using tags:
                        <a href="/tags/build">build</a>, <a href="/tags/testdata">testdata</a>, <a href="/tags/grails">grails</a>, <a href="/tags/spock">spock</a>, <a href="/tags/test">test</a>
                </span>
            </div>
        </div>
    </div>
</article>

            </div>
        </div>
    </div>
  
<footer>
    <div class="container">
        <div class="row">
            <div class="twelve columns">
                <div id="social">
                    
                        <a title="Twitter" href="https://twitter.com/marcopas">
                            <i class="fab fa-twitter"></i>
                        </a>
                    
                    
                        <a title="LinkedIn" href="https://www.linkedin.com/in/marcopas">
                            <i class="fab fa-linkedin"></i>
                        </a>
                    
                    
                        <a title="GitHub" href="https://github.com/mpas">
                            <i class="fab fa-github"></i>
                        </a>
                    
                    
                        <a title="StackOverflow" href="http://stackoverflow.com/users/185432/marco">
                            <i class="fab fa-stack-overflow"></i>
                        </a>
                    
                    
                    
                    
                        <a title="Email" href="mailto:marco.pasopas@gmail.com">
                            <i class="far fa-envelope"></i>
                        </a>
                    
            </div>
        </div>

        <div class="row">
            <div class="twelve columns" id="copyright">&copy; 2020 ~ CodeVerse / Powered by <a href="http://gohugo.io/">Hugo</div>
        </div>
    </div>
</footer>
</body>
</html>

