<!DOCTYPE html>
<html class="no-js" lang="en-us" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="description" content="Adding WebSocket/Stomp support to a Spring Boot application">
    <meta name="author" content="Marco Pas">

    <meta name="keyword" content="">
    <link rel="shortcut icon" href="/favicon.ico">

    <title>Adding WebSocket/Stomp support to a Spring Boot application &middot; CodeVerse</title>

   	
    
        <link rel="stylesheet" href="http://mpas.github.io/css/theme/cerulean.css">
    

    <link rel="stylesheet" href="http://mpas.github.io/css/font-awesome.min.css">

   	
   	<link rel="stylesheet" href="http://mpas.github.io/css/style.css">


    
    <script src="http://mpas.github.io/js/jquery.min-2.1.4.js"></script>
    <script src="http://mpas.github.io/js/bootstrap.min-3.3.5.js"></script>

    
    <link href="" rel="alternate" type="application/rss+xml" title="CodeVerse" />
</head>
<body lang="en">
    
    <div class="container">
    <div class="row">
        <div class="navbar navbar-default navbar-inverse" role="navigation">
            <div class="navbar-header">
                <a class="navbar-brand" href="http://mpas.github.io">CodeVerse</a>
            </div>
            <div class="navbar-collapse collapse navbar-responsive-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="http://mpas.github.io">Home</a></li>
                    <li><a href="http://mpas.github.io/post/">Blog</a></li>
                    
                      <li><a href="/blog/2015/10/30/about/"> About </a></li>
                    
                </ul>
            </div>
        </div>
    </div>
</div>



<div class="container">
	<div class="row">
		<div class="col-md-offset-1 col-md-10">
			<h3>Adding WebSocket/Stomp support to a Spring Boot application</h3>
				<span class="label label-primary">16.06.2015</span> in 
				
					
					<a href="/categories/development">Development</a>
				 using tags
				
					
					<a href="/tags/spring-boot">spring-boot</a>
				
					 , 
					<a href="/tags/websocket">websocket</a>
				
			</small>
		</div>
	</div>
	<div class="row">
		<div class="col-md-offset-1 col-md-10">
			<br>
			<p>Adding support for <a href="https://en.wikipedia.org/wiki/WebSocket">WebSockets</a> / <a href="https://en.wikipedia.org/wiki/Streaming_Text_Oriented_Messaging_Protocol">Stomp</a> in a <a href="http://projects.spring.io/spring-boot/">Spring Boot</a> application has never been more easy. You can use WebSockets to receive serverside events or push data to the server using WebSockets.</p>

<p>The following example will enable a server to send messages to a WebSocket/Stomp client.</p>

<ul>
<li>Modify <code>build.gradle</code></li>
</ul>

<pre><code>dependencies {
    compile(&quot;org.springframework.boot:spring-boot-starter-web&quot;)
    compile(&quot;org.springframework.boot:spring-boot-starter-websocket&quot;)
    compile(&quot;org.springframework:spring-messaging&quot;)
    testCompile(&quot;junit:junit&quot;)
}
</code></pre>

<ul>
<li>Create a WebSocket configuration class that holds the configuration</li>
</ul>

<pre><code>@Configuration
@EnableWebSocketMessageBroker
public class WebSocketConfig extends AbstractWebSocketMessageBrokerConfigurer {

    @Override
    public void registerStompEndpoints(StompEndpointRegistry registry) {
        // the endpoint for websocket connections
        registry.addEndpoint(&quot;/stomp&quot;).withSockJS();
    }

    @Override
    public void configureMessageBroker(MessageBrokerRegistry config) {
        // use the /topic prefix for outgoing WebSocket communication
        config.enableSimpleBroker(&quot;/topic&quot;);

        // use the /app prefix for others
        config.setApplicationDestinationPrefixes(&quot;/app&quot;);
    }
}
</code></pre>

<p>Now a client that connects to <code>/stomp</code> endpoint is able to receive WebSocket messages.</p>

<ul>
<li>Create a service that is going to send the data to a WebSocket endpoint</li>
</ul>

<pre><code>@Service
public class ScheduleTask {

    @Autowired
    private SimpMessagingTemplate template;

    // this will send a message to an endpoint on which a client can subscribe
    @Scheduled(fixedRate = 5000)
    public void trigger() {
        // sends the message to /topic/message
        this.template.convertAndSend(&quot;/topic/message&quot;, &quot;Date: &quot; + new Date());
    }

}
</code></pre>

<ul>
<li>Create a client that is able to receive the message</li>
</ul>

<pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;WebSocket Stomp Receiving Example&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div&gt;
        &lt;h3&gt;Messages:&lt;/h3&gt;
        &lt;ol id=&quot;messages&quot;&gt;&lt;/ol&gt;
    &lt;/div&gt;

    &lt;script type=&quot;text/javascript&quot; src=&quot;//cdn.jsdelivr.net/jquery/1.11.2/jquery.min.js&quot;&gt;&lt;/script&gt;
    &lt;script type=&quot;text/javascript&quot; src=&quot;//cdn.jsdelivr.net/sockjs/0.3.4/sockjs.min.js&quot;&gt;&lt;/script&gt;
    &lt;script type=&quot;text/javascript&quot; src=&quot;//cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js&quot;&gt;&lt;/script&gt;

    &lt;script type=&quot;text/javascript&quot;&gt;
        $(document).ready(function() {
            var messageList = $(&quot;#messages&quot;);

            // defined a connection to a new socket endpoint
            var socket = new SockJS('/stomp');

            var stompClient = Stomp.over(socket);

            stompClient.connect({ }, function(frame) {
                // subscribe to the /topic/message endpoint
                stompClient.subscribe(&quot;/topic/message&quot;, function(data) {
                    var message = data.body;
                    messageList.append(&quot;&lt;li&gt;&quot; + message + &quot;&lt;/li&gt;&quot;);
                });
            });
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>The whole example project  can be downloaded <a href="https://github.com/mpas/spring-boot-websocket-stomp-server-send-example">https://github.com/mpas/spring-boot-websocket-stomp-server-send-example</a></p>

		</div>
	</div>
	<div class="row">
		<div class="col-md-12">
			<hr>
		</div>
	</div>
</div>

    <div class="container">
        <div class="row col-md-12">
            <footer>
                <div class="pull-left">
                    <p>
                        &copy; 2015 ~ Marco Pas ~ Powered By <a href="http://hugo.spf13.com">Hugo</a> - version: 0.14 ~ <a href="http://mpas.github.io/license">License</a>
                    </p>
                </div>

                
                <div class="pull-right">
                    
                        <a href="" target="_blank">
                        <i class="fa fa-linkedin fa-2x"></i></a>
                    
                    
                        <a href="https://www.facebook.com/marco.pasopas" target="_blank">
                        <i class="fa fa-facebook-square fa-2x"></i></a>
                    
                    
                        <a href="https://twitter.com/marcopas" target="_blank">
                        <i class="fa fa-twitter-square fa-2x"></i></a>
                    
                    
                        <a href="https://github.com/mpas" target="_blank">
                        <i class="fa fa-github-square fa-2x"></i></a>
                    
                    
                        <a href="https://delicious.com/marcopas" target="_blank">
                        <i class="fa fa-delicious fa-2x"></i></a>
                    
                    
                        <a href="https://www.flickr.com/photos/marcopas/" target="_blank">
                        <i class="fa fa-flickr fa-2x"></i></a>
                    
                        <a href="" target="_blank">
                        <i class="fa fa-rss-square fa-2x"></i></a>
                </div>
            </footer>
        </div>
    </div>

    
    </body>
</html>

